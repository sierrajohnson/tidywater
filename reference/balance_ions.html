<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add an ion to balance overall charge in a water — balance_ions • tidywater</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add an ion to balance overall charge in a water — balance_ions"><meta name="description" content="This function takes a water defined by define_water and balances charge.
For a single water use balance_ions; for a dataframe use balance_ions_df.
Use pluck_cols = TRUE to get values from the output water as new dataframe columns."><meta property="og:description" content="This function takes a water defined by define_water and balances charge.
For a single water use balance_ions; for a dataframe use balance_ions_df.
Use pluck_cols = TRUE to get values from the output water as new dataframe columns."><meta property="og:image" content="https://BrownandCaldwell-Public.github.io/tidywater/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidywater</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tidywater.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/coeff_fitting_chemdose_dbp.html">Fitting and using custom coefficients in chemdose_dbp</a></li>
    <li><a class="dropdown-item" href="../articles/help_functions_blend_waters.html">Blending Multiple Waters</a></li>
    <li><a class="dropdown-item" href="../articles/help_functions_chemdose_ph.html">Helper Functions &amp; Dose Chemicals</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Introduction to tidywater: Basic functions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BrownandCaldwell-Public/tidywater/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add an ion to balance overall charge in a water</h1>
      <small class="dont-index">Source: <a href="https://github.com/BrownandCaldwell-Public/tidywater/blob/main/R/balance_ions.R" class="external-link"><code>R/balance_ions.R</code></a></small>
      <div class="d-none name"><code>balance_ions.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes a water defined by <a href="define_water.html">define_water</a> and balances charge.
For a single water use <code>balance_ions</code>; for a dataframe use <code>balance_ions_df</code>.
Use <code>pluck_cols = TRUE</code> to get values from the output water as new dataframe columns.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">balance_ions</span><span class="op">(</span><span class="va">water</span>, anion <span class="op">=</span> <span class="st">"cl"</span>, cation <span class="op">=</span> <span class="st">"na"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">balance_ions_df</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  input_water <span class="op">=</span> <span class="st">"defined"</span>,</span>
<span>  output_water <span class="op">=</span> <span class="st">"balanced"</span>,</span>
<span>  pluck_cols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  water_prefix <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  anion <span class="op">=</span> <span class="st">"cl"</span>,</span>
<span>  cation <span class="op">=</span> <span class="st">"na"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-water">water<a class="anchor" aria-label="anchor" href="#arg-water"></a></dt>
<dd><p>Water created with <a href="define_water.html">define_water</a>, which may have some ions set to 0 when unknown</p></dd>


<dt id="arg-anion">anion<a class="anchor" aria-label="anchor" href="#arg-anion"></a></dt>
<dd><p>Selected anion to use to for ion balance when more cations are present. Defaults to "cl". Choose one of c("cl", "so4").</p></dd>


<dt id="arg-cation">cation<a class="anchor" aria-label="anchor" href="#arg-cation"></a></dt>
<dd><p>Selected cation to use to for ion balance when more anions are present. Defaults to "na". Choose one of c("na", "k", "ca", or "mg").</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>a data frame containing a water class column, which has already been computed using <a href="define_water_df.html">define_water_df</a></p></dd>


<dt id="arg-input-water">input_water<a class="anchor" aria-label="anchor" href="#arg-input-water"></a></dt>
<dd><p>name of the column of water class data to be used as the input for this function. Default is "defined_water".</p></dd>


<dt id="arg-output-water">output_water<a class="anchor" aria-label="anchor" href="#arg-output-water"></a></dt>
<dd><p>name of the output column storing updated water classes. Default is "balanced_water".</p></dd>


<dt id="arg-pluck-cols">pluck_cols<a class="anchor" aria-label="anchor" href="#arg-pluck-cols"></a></dt>
<dd><p>Extract water slots modified by the function (selected cation and anion) into new numeric columns for easy access. Default to FALSE.</p></dd>


<dt id="arg-water-prefix">water_prefix<a class="anchor" aria-label="anchor" href="#arg-water-prefix"></a></dt>
<dd><p>Append the output_water name to the start of the plucked columns. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>balance_ions</code> returns a single water class object with updated ions to balance water charge.</p>
<p><code>balance_ions_df</code> returns a dataframe with a new column with the ion balanced water</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If more cations are needed, sodium will be added. User may specify which cation ("na", "k", "ca", or "mg") to use for balancing.
If calcium and magnesium are not specified when defining a water with
<a href="define_water.html">define_water</a>, they will default to 0 and not be changed by this function unless specified in the cation argument.
Anions are added by default with chloride. User may specify which anion ("cl", "so4") to use for balancing.
This function is purely mathematical.
User should always check the outputs to make sure values are reasonable for the input source water.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">water_defined</span> <span class="op">&lt;-</span> <span class="fu"><a href="define_water.html">define_water</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">20</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">80</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">balance_ions</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>User entered total hardness is &gt;10% different than calculated hardness.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">water_defined</span> <span class="op">&lt;-</span> <span class="fu"><a href="define_water.html">define_water</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">20</span>, <span class="fl">50</span>, tot_hard <span class="op">=</span> <span class="fl">150</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">balance_ions</span><span class="op">(</span>anion <span class="op">=</span> <span class="st">"so4"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Missing values for calcium and magnesium but total hardness supplied. Default ratio of 65% Ca2+ and 35% Mg2+ will be used.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Major ions missing and neither TDS or conductivity entered. Ideal conditions will be assumed. Ionic strength will be set to NA and activity coefficients in future calculations will be set to 1.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">example_df</span> <span class="op">&lt;-</span> <span class="va">water_df</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="define_water_df.html">define_water_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">balance_ions_df</span><span class="op">(</span>anion <span class="op">=</span> <span class="st">"so4"</span>, cation <span class="op">=</span> <span class="st">"ca"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sierra Johnson, Libby McKenna, Riley Mulhern, Chris Corwin, Brown and Caldwell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

